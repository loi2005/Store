!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Dux={})}(this,(function(e){"use strict";for(var t,n=[],o=0;o<256;++o)n.push((o+256).toString(16).slice(1));var i=new Uint8Array(16);function r(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(i)}var a,s,c,d,u,l,p,m={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function f(e,t,o){if(m.randomUUID&&!t&&!e)return m.randomUUID();var i=(e=e||{}).random||(e.rng||r)();return i[6]=15&i[6]|64,i[8]=63&i[8]|128,function(e,t=0){return(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase()}(i)}!function(e){e.MultiTrackToken="_shopify_y",e.SessionToken="_shopify_s",e.ExperimentAssignmentCookie="_assignment",e.GoogleAnalyticsId="_ga",e.Source="source",e.CookieNoticeAcknolwedged="eu_cookies_acknowledged",e.PrivacySignal="privacy_signal",e.LastShop="last_shop",e.IsShopifyMerchant="is_shopify_merchant",e.Affiliate="source",e.DidomiToken="didomi_token",e.DidomiTokenCpra="didomi_token_cpra",e.MarketingEncryptedCookies="_shopify_marketing"}(a||(a={})),function(e){e.Gdpr="gdpr",e.Ccpa="ccpa",e.None="none"}(s||(s={})),function(e){e.Accepted="1",e.Rejected="-1"}(c||(c={})),function(e){e.PassiveConsent="passive_consent",e.ActiveConsent="active_consent"}(d||(d={})),function(e){e.BasicAuth="x-basic-auth",e.CacheControl="cache-control",e.ContentType="content-type",e.Cookie="cookie",e.CfConnectingIp="cf-connecting-ip",e.CfIpcountry="cf-ipcountry",e.EdgeThreatScore="edge-threat-score",e.HttpXForwardedFor="http_x_forwarded_for",e.Origin="origin",e.OxygenBuyerIp="oxygen-buyer-ip",e.OxygenBuyerCountry="oxygen-buyer-country",e.OxygenBuyerRegionCode="oxygen-buyer-region-code",e.Referrer="referer",e.UserAgent="user-agent",e.XBrochureDebugCountry="x-brochure-debug-country",e.XBrochureDomain="x-brochure-domain",e.XForwardedFor="x-forwarded-for",e.XForwardedHost="x-forwarded-host",e.XGeoCountryCode="x-geo-country-code",e.XGeoRegionCode="x-geo-region-code",e.XIpMetadata="x-ip-metadata",e.XRealIp="x-real-ip",e.XEdgeExp="x-edge-exp"}(u||(u={})),function(e){e.Delete="DELETE",e.Get="GET",e.Head="HEAD",e.Options="OPTIONS",e.Patch="PATCH",e.Post="POST",e.Put="PUT"}(l||(l={})),function(e){e.SetCookie="set-cookie",e.AccessControlAllowOrigin="access-control-allow-origin",e.AccessControlAllowCredentials="access-control-allow-credentials",e.AccessControlAllowMethods="access-control-allow-methods",e.AccessControlAllowHeaders="access-control-allow-headers"}(p||(p={}));const h="data-dux-initialized",g={default:{au:"en-AU",be:"nl-BE","be-de":"de-BE","be-en":"en-BE","be-fr":"fr-BE",br:"pt-BR",ca:"en-CA","ca-fr":"fr-CA",cn:"zh-CN",co:"es-CO",cs:"cs",de:"de",default:"en",dk:"da","dk-en":"en-DK",en:"en",es:"es","es-es":"es-ES",fi:"fi",fr:"fr",hk:"zh-HK","hk-en":"en-HK",id:"en-ID",ie:"en-IE",in:"en-IN",it:"it",jp:"ja",ko:"ko",kr:"ko",mx:"es-MX",my:"en-MY",ng:"en-NG",nl:"nl","no-en":"en-NO",nz:"en-NZ",ph:"en-PH","pt-pt":"pt-PT","pt-br":"pt-BR",se:"sv",sg:"en-SG",th:"th",tr:"tr",tw:"zh-TW",uk:"en-GB",vi:"vi",vn:"vi",za:"en-ZA",zh:"zh-CN","zh-cn":"zh-CN","zh-tw":"zh-TW"},"www.shopify.ca":"en-CA","www.shopify.co.uk":"en-GB","www.shopify.in":"en-IN","www.shopify.com.au":"en-AU","www.shopify.co.id":"en-ID","www.shopify.com.br":"pt-BR","www.shopify.co.nz":"en-NZ","www.shopify.co.za":"en-ZA","www.shopify.com.ng":"en","www.shopify.com.ph":"en-PH","www.shopify.com.sg":"en-SG","www.shopify.hk":"zh-HK","en.shopify.hk":"en-HK","www.shopify.ie":"en-IE","en.shopify.be":"en-BE","www.shopify.my":"en-MY","en.shopify.dk":"en-DK","en.shopify.no":"en-NO","es.shopify.com":"es","www.shopify.es":"es-ES","www.shopify.com.co":"es-CO","www.shopify.com.mx":"es-MX","www.shopify.fr":"fr","fr.shopify.ca":"fr-CA","fr.shopify.be":"fr-BE","www.shopify.nl":"nl","www.shopify.be":"nl-BE","www.shopify.jp":"ja","www.shopify.tw":"zh-TW","www.shopify.de":"de","de.shopify.be":"de-BE","it.shopify.com":"it","www.shopify.dk":"da","www.shopify.co.kr":"ko","www.shopify.se":"sv","zh.shopify.com":"zh-CN","www.shopify.net.vn":"vi"},w="home",y=e=>{if("undefined"==typeof document)return;const t=new RegExp(`(?:^|; )${e}=([^;]*)(?:$|; )`),n=document?.cookie.match(t);return n?decodeURIComponent(n[1]):""},v=(e,t,n)=>{if("undefined"==typeof document)return void console.warn("setCookie should only be called client-side",new Error("setCookie called outside of browser context."));let o=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(n.maxage&&(n.maxage<0?n.expires=new Date(0):n.expires=new Date((new Date).getTime()+n.maxage)),n.path&&(o+=`; path=${n.path}`),n.domain){let e=n.domain.split(".");"www"===e[0]&&(e=e.slice(1));const t=e.indexOf("shopify");t>=0&&(e=e.slice(t)),o+=`; domain=.${e.join(".")}`}n.expires&&(o+=`; expires=${n.expires.toUTCString()}`),n.samesite?o+=`; SameSite=${n.samesite}`:o+="; SameSite=lax",n.secure&&!window.E2E&&(o+="; secure"),document.cookie=o},b=e=>{const t=new URL(e).searchParams,n={},o=t.get("debug_didomi_gdpr"),i=Boolean(t.get("debug_didomi_ccpa")),r=t.get("debug_didomi_lang");return i?n.user={country:"US",region:"CA"}:o&&(n.user={country:o.toUpperCase()}),r&&(n.languages={enabled:[r.toLowerCase()]}),n};var k;!function(e){e.ButtonClick="button_click",e.LinkClick="link_click",e.OutboundLinkClick="outbound_link_click",e.DropDownClick="dropdown_click",e.DropDownSelect="dropdown_select",e.InputSelect="input_select",e.ImageClick="image_click"}(k||(k={}));const T=e=>{let t=e;try{t=decodeURIComponent(e)}catch(e){}return t=t.replace(/[A-Z]{2,}/g,(e=>`${e.charAt(0)}${e.substring(1).toLowerCase()}`)),t=t.charAt(0).toLowerCase()+t.substring(1),t=t.replace(/[\s_:./,\\\n|]/g,"-"),t=t.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`)),t=t.replace(/-{2,}/g,"-"),t=t.replace(/[^a-z0-9-]/g,"?"),t=t.replace(/(^-)|(-$)/g,""),t=t.substring(0,50),t},C=e=>{const t=e.tagName.toLowerCase();switch(t){case"button":return k.ButtonClick;case"a":return(e=>{try{return new URL(e,document.baseURI).origin.match(/shopify.|myshopify.io|spin.dev/)}catch(e){return console.error("isShopifyLink",e),!1}})(e.getAttribute("href")||"")?k.LinkClick:k.OutboundLinkClick;case"select":return k.DropDownClick;case"option":return k.DropDownSelect;case"input":return"button"===e.type?k.ButtonClick:k.InputSelect;case"img":return k.ImageClick;default:return`${t}_click`}},E=(e,t)=>{const n={};for(const o in e)if(o.startsWith(t)){const i=o.substring(t.length);if(i){const t=i.charAt(0).toLowerCase()+i.substring(1)||"";t&&(n[t]=e[o]||"")}}return n},x=(e,t)=>{const n=document.evaluate(`ancestor::*[@${t}[1]]`,e,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);let o;const i=[];for(;o=n.iterateNext();){const e=o.getAttribute(t);e&&i.push({node:o,attr:t,attrVal:e})}return i},I=(e,t=["data-section-name","data-component-name","id"])=>{let n,o;for(o of t)if(n=x(e,o),n.length>0)break;return n},S=e=>{if(!e)return 0;const{attr:t,attrVal:n,node:o}=e,i=document.querySelectorAll(`[${t}="${n}"]`);return i.length<=1?0:Array.from(i).findIndex((e=>e.isEqualNode(o)))},_=(e,t=!0,n)=>{if(!e)return{};const o=(e=>{const t=e.dataset.sectionName||e.dataset.componentName||e.getAttribute("name")||e.getAttribute("id")||e.getAttribute("aria-label")||e.innerText||e.textContent||`unhandled-${e.tagName}`;return T(t)})(e),i=C(e),{name:r,index:a}=((e,t)=>{const n=(I(e,t)||[]).pop(),{attrVal:o=""}=n||{},i=S(n);return{name:T(o||"unhandled-parent-section"),index:i}})(e),s=I(e,n)||[],c=[],d=((e,t="data-component-extra-")=>{const n=document.evaluate(`ancestor::*[@*[starts-with(name(), ${t})]]`,e,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),o=t.toLowerCase().replace(/^data-|^-/,"").replace(/-./g,(e=>(e[1]||"").toUpperCase())).replace(/-/g,""),i={};let r;for(;r=n.iterateNext();)Object.assign(i,E(r.dataset,o));return Object.assign(i,E(e.dataset,o)),i})(e);s.forEach((({attrVal:e})=>{c.push(T(e))})),c.push(o);return{elementName:o,elementType:i,sectionName:r,sectionIndex:a,componentTree:c.join("|").concat(t?`:${T(e.tagName)}`:""),extraMetadata:d}};var L;!function(e){e.Click="website_click_event/1.5",e.ComponentViewability="website_component_viewability_event/1.5",e.ConversionSignalPageView="conversion_signal_pageview/2.1",e.Error="website_error_event/1.1",e.Form="website_form_event/2.0",e.MarketingId="website_marketing_id/1.0",e.MarketingPageEvent="marketing_page_event/2.0",e.PageView="website_client_page_view/2.13",e.ServerPageView="website_server_page_view/2.9",e.ServerRequest="website_server_request/1.0",e.Scroll="website_scroll_event/1.0",e.UserSession="website_user_session/2.2",e.UserSessionMarketing="website_user_session_marketing/1.1",e.VisibilityChange="website_visibility_change_event/1.0",e.WebVitals="website_web_vitals_event/2.0",e.PrivacySignal="website_privacy_signal/1.0",e.TrafficQuality="website_traffic_quality/1.0"}(L||(L={}));let A=0;const V={};function N(...[e,t,n=window,o]){A+=1;const i=A.toString();return n.addEventListener(e,t,o),V[i]={listenerId:i,eventType:e,context:n,callback:t,options:o},i}function M(e,t){if("object"==typeof e)e.forEach((e=>M(e)));else{const n=e.toString();if(V[n]){const{context:e,eventType:t,callback:o,options:i}=V[n];e.removeEventListener(t,o,i),delete V[n]}else Object.keys(V).filter((e=>V[e].eventType===n&&!t)).forEach((e=>M(e)))}}function P(){Object.keys(V).forEach((e=>M(e)))}function O(...[e,t,n=window,o]){const i=N(e,((...e)=>{t.apply(n,e),M(i)}),n,o);return i}function D(e){const t=[];return e.forEach((([e,n,o=window,i])=>{t.push(N(e,((e,n)=>(...o)=>{t.forEach((e=>M(e))),e.apply(n,o)})(n,o),o,i))})),t}const R=(e,t=[])=>{const n={};for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const i=e[o];if(t.indexOf(o)>=0)n[o]=i;else{n[o.replace(/[A-Z]/g,(e=>`_${e.toLocaleLowerCase()}`))]=i}}return n},B=e=>{const t=e.getBoundingClientRect(),n=!(e=>{let t=e;for(;t&&"body"!==t.nodeName.toLowerCase();){if(getComputedStyle(t).getPropertyValue("position").match(/fixed|sticky/i))return!0;t=t.parentNode}return!1})(e);return{left:Math.round(t.left+(n?window.scrollX-e.clientLeft:0)),top:Math.round(t.top+(n?window.scrollY-e.clientTop:0))}};let U;const H=(e,t,n)=>{U=n=>{(({element:e,clientMessageId:t=f(),eventType:n,track:o,store:i,options:r={extraMetadata:{}}})=>{const a=e.closest("a, button, [data-click-enabled], input, select");if(!a)return;if(a.matches('[data-click-disabled], [data-click-enabled="false"]'))return;const{left:s,top:c}=B(a),{elementName:d,elementType:u,sectionName:l,sectionIndex:p,componentTree:m,extraMetadata:h}=_(a),g={...h,...r?.extraMetadata},w=a.getAttribute("href")||"";let y=a.innerText||a.textContent||a.getAttribute("aria-label")||"";y=[...y].slice(0,50).join("");const v={schemaId:L.Click,payload:{pageViewToken:i.pageViewToken||"",componentTree:m,xCoord:s,yCoord:c,recirculation:w,targetName:d,parentName:l,parentIndex:p,clickType:u,eventType:n,innerText:y,extraMetadata:JSON.stringify(g)}};if(o.dux(v,{clientMessageId:t}),o.gtm){const t=e.closest("[data-event-category], [data-ga-event], [data-ga-category]");let n;n=t?t.dataset:{eventCategory:p?`${l}-${p}`:l,eventAction:u,eventLabel:d},Object.assign(n,{event:u,eventName:u,eventType:d,eventText:y,eventLocation:p?`${l}-${p}`:l,eventUrl:w,extraMetadata:JSON.stringify(R(g))}),o.gtm(n)}})({element:n.target,eventType:n.type,track:e,store:t})},(e=>{U&&e?.forEach((e=>{N("click",U,e,!0),N("contextmenu",U,e,!0),N("auxclick",U,e,!0)}))})(n)};var j,$;!function(e){e.BeforeUnload="beforeunload",e.Error="error",e.Load="load",e.PageHide="pagehide",e.PageShow="pageshow",e.Scroll="scroll",e.VisibilityChange="visibilitychange"}(j||(j={})),function(e){e.ComponentViewability="component_viewability"}($||($={}));let q=0;const F={},z={},W=e=>{if(!e)return;e.timer&&clearTimeout(e.timer);const{dom:t,id:n,observer:o,threshold:i}=e;o.unobserve(t),delete z[n],Object.values(z).every((e=>e.observer!==o))&&delete F[i]},G=({dom:e,handler:t,track:n,store:o,options:i,clientMessageId:r=f()})=>{if(e){q+=1;const a=q.toString(),s=i?.threshold||.2,c=i?.duration||0,d=(({track:e,store:t,threshold:n})=>(F[n]||(F[n]=new IntersectionObserver(Z(e,t),{root:null,threshold:n})),F[n]))({track:n,store:o,threshold:s}),u={id:a,dom:e,handler:t,observer:d,threshold:s,duration:c,clientMessageId:r,extraMetadata:i?.extraMetadata||{}};return z[a]=u,d.observe(e),u}},X=({observation:e,store:t,track:n})=>{const{dom:o,threshold:i,duration:r}=e,{componentTree:a,extraMetadata:s,elementName:c,sectionName:d,sectionIndex:u}=_(o,!1),l={...s,...e.extraMetadata},p={schemaId:L.ComponentViewability,payload:{pageViewToken:t.pageViewToken||"",componentTree:a,targetName:c,parentName:d,parentIndex:u,componentWidth:o.clientWidth,componentHeight:o.clientHeight,verticalPosition:Math.round(window.scrollY+o.getBoundingClientRect().top),horizontalPosition:Math.round(window.scrollX+o.getBoundingClientRect().left),duration:r,threshold:i,extraMetadata:JSON.stringify(l)}};n.dux(p,{clientMessageId:e.clientMessageId}),n.gtm&&n.gtm({event:$.ComponentViewability,eventType:c,eventLocation:a,extraMetadata:JSON.stringify(R(l))}),W(e)},Z=(e,t)=>n=>{n.forEach((n=>{const o=n?.target,i=(e=>{const t=Object.keys(z).find((t=>{const{dom:n}=z[t]||{};return n&&n===e}));return t?z[t]:void 0})(o);if(!i)return;const r={store:t,track:e,dom:o,clientMessageId:i.clientMessageId,parentSchemaId:L.ComponentViewability};n.isIntersecting?i.duration>0?i.timer=setTimeout((()=>{X({observation:i,store:t,track:e}),i.handler?.({...r,isIntersecting:!0})}),i.duration):(i.handler?.({...r,isIntersecting:!0}),X({observation:i,store:t,track:e})):(i.handler?.({...r,isIntersecting:!1}),i.timer&&clearTimeout(i.timer))}))},K=e=>void 0!==e?parseInt(e,10):void 0,J=(e,t)=>{O(j.Error,(n=>{const o=n?.error?.stack||n?.error?.message||n?.message,{filename:i,lineNumber:r,columnNumber:a}=(e=>{if("string"!=typeof e)return{};const t=e?.replace(/[^\w\s\n():/.$-]/g,""),n=t?.match(/(https?:\/\/[^\s:\n]+|\/[^\s:\n]+)/)||[],o=t?.match(/:\d+:\d+/),i=o?.[0].split(":");return{filename:n[1],lineNumber:K(i?.[1]),columnNumber:K(i?.[2])}})(o)||{},s={url:location.href};a&&(s.columnNumber=n.colno||a);const c={schemaId:L.Error,payload:{pageViewToken:t.pageViewToken||"",message:n.error?.message||n.message||"Unknown error",fileName:n.filename||i,stack:n.error?.stack,lineNumber:n.lineno||r,extraMetadata:JSON.stringify(s)}};e.dux(c)}),window)},Y=(e,t)=>{N("submit",(n=>{if(!n)return;const{hasError:o,message:i,action:r,componentTree:a,submitterComponentTree:s}=(e=>{const t=e?.currentTarget instanceof HTMLFormElement?e?.currentTarget:e?.target,n=e?.submitter||e?.target,{action:o}=t,i=e.defaultPrevented;let r,a="";i&&(r=Array.from(t.elements).find((e=>e instanceof HTMLInputElement&&e.validationMessage)),r&&(a=`${r.name||r.id}: ${r?.validationMessage}`));const{componentTree:s=""}=_(t,!1),{componentTree:c=""}=_(n,!0);return{formEl:t,submitterEl:n,errorEl:r,hasError:i,action:o,message:a,componentTree:s,submitterComponentTree:c}})(n),c={schemaId:L.Form,payload:{pageViewToken:t.pageViewToken||"",action:r,state:o?"error":"success",componentTree:a,submitterComponentTree:s,message:i}};e.dux(c)}),document?.body,!0)},Q=e=>(document.querySelector('link[rel="canonical"]')?.getAttribute("href")||e).split("?")[0].split("#")[0],ee=e=>{if(e)try{const{pathname:t}=new URL(e);return(t.split("/").filter(Boolean).join("/")||w).toLowerCase()}catch(e){console.error("malformed href",e)}return""};let te;const ne=({track:e,store:t,softNavigation:n=!1})=>{const o=location.toString();te=o;const i=new URL(o),r=i.hostname,a=i.pathname,s=t.metadata?.handle||((e,t)=>{let n=ee(document.querySelector('link[rel="alternate"][hreflang="en"]')?.getAttribute("href"));return n||(n=ee(Q(e))),t&&n===t.toLowerCase()&&(n=w),n})(i.href,t?.metadata?.site?.pathPrefix),c=document.referrer||"",d=t.metadata?.page?.experimentVariationId||t.experimentVariationId,u=t.pageViewToken||"",l=t.mode||"development",p={schemaId:L.PageView,payload:{pageViewToken:u,userLocale:navigator&&navigator.language||"",url:o,domain:r,path:a,urlHash:location&&location.hash||"",canvasHeight:Math.round(document.body.clientHeight),canvasWidth:Math.round(document.body.clientWidth),viewportHeight:Math.round(window.innerHeight),viewportWidth:Math.round(window.innerWidth),version:"3.4.1",siteEnvironment:l,application:t.service||"default-application",handle:s,shopId:t.shopId,softNavigation:n,canonicalUrl:Q(i.href),...t.tabToken?{tabToken:t.tabToken}:{}}};e.dux(p),t.metadata&&e.dux({userLanguage:navigator&&navigator.language||"",url:o,referrer:c,httpStatusCode:"error-404"===s?"404":"200",pageViewToken:t.pageViewToken,siteEnvironment:l,...d?{experimentVariationId:d}:{},...t.sessionId?{sessionId:t.sessionId}:{},...t.identityUuid?{identityUuid:t.identityUuid}:{},...t.userId?{userId:t.userId}:{},...t.shopifyEmployee?{shopifyEmployee:t.shopifyEmployee}:{},...t.shopifyEmployeeId?{shopifyEmployeeId:t.shopifyEmployeeId}:{},...t.shopId?{shopId:t.shopId}:{}},{flush:!0})};let oe;const ie="hidden",re="visible";function ae(e,t){let n,o;return(...i)=>(n&&clearTimeout(n),o&&cancelAnimationFrame(o),new Promise((r=>{t||"undefined"==typeof requestAnimationFrame?n=setTimeout((()=>{const t=e(...i);r(t)}),t):o=requestAnimationFrame((()=>{const t=e(...i);r(t)}))})))}let se=[],ce=null;const de=(e,t)=>{let n=0,o=0,i=!1;const r=t.pageViewToken;se.forEach((e=>M(e))),se=[],ce&&M(ce),ce=null;const a=()=>{const e=(document?.documentElement?.scrollHeight||document?.body?.scrollHeight)-document?.documentElement?.clientHeight,t=document?.documentElement?.scrollTop||document?.body?.scrollTop,i=t?Math.round(t/e*100):0;return i>n&&(n=i,o=n<25?0:n<50?25:n<75?50:n<95?75:100),o},s=e=>{const t=a();c(t)},c=t=>{if(i)return;i=!0;const n={schemaId:L.Scroll,payload:{pageViewToken:r,quadrant:t}};e.dux(n,{flush:!0}),e.gtm&&e.gtm({event:j.Scroll,scrollDepth:t}),se.forEach((e=>M(e)))},d=ae((()=>{const e=a();100===e&&c(e)}));se.push(N(j.Scroll,d,document),N(j.Scroll,d,document),N(j.BeforeUnload,s,document.body),N(j.VisibilityChange,s,document),N(j.PageHide,s,window)),ce=O(L.PageView,(n=>{c(o),de(e,t)}),document),d()};var ue,le,pe,me,fe=-1,he=function(e){addEventListener("pageshow",(function(t){t.persisted&&(fe=t.timeStamp,e(t))}),!0)},ge=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},we=function(){var e=ge();return e&&e.activationStart||0},ye=function(e,t){var n=ge(),o="navigate";return fe>=0?o="back-forward-cache":n&&(document.prerendering||we()>0?o="prerender":document.wasDiscarded?o="restore":n.type&&(o=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:o}},ve=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var o=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return o.observe(Object.assign({type:e,buffered:!0},n||{})),o}}catch(e){}},be=function(e,t,n,o){var i,r;return function(a){t.value>=0&&(a||o)&&((r=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=r,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},ke=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},Te=function(e){var t=function(t){"pagehide"!==t.type&&"hidden"!==document.visibilityState||e(t)};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},Ce=function(e){var t=!1;return function(n){t||(e(n),t=!0)}},Ee=-1,xe=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},Ie=function(e){"hidden"===document.visibilityState&&Ee>-1&&(Ee="visibilitychange"===e.type?e.timeStamp:0,_e())},Se=function(){addEventListener("visibilitychange",Ie,!0),addEventListener("prerenderingchange",Ie,!0)},_e=function(){removeEventListener("visibilitychange",Ie,!0),removeEventListener("prerenderingchange",Ie,!0)},Le=function(){return Ee<0&&(Ee=xe(),Se(),he((function(){setTimeout((function(){Ee=xe(),Se()}),0)}))),{get firstHiddenTime(){return Ee}}},Ae=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},Ve=[1800,3e3],Ne=function(e,t){t=t||{},Ae((function(){var n,o=Le(),i=ye("FCP"),r=ve("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(r.disconnect(),e.startTime<o.firstHiddenTime&&(i.value=Math.max(e.startTime-we(),0),i.entries.push(e),n(!0)))}))}));r&&(n=be(e,i,Ve,t.reportAllChanges),he((function(o){i=ye("FCP"),n=be(e,i,Ve,t.reportAllChanges),ke((function(){i.value=performance.now()-o.timeStamp,n(!0)}))})))}))},Me=[.1,.25],Pe={passive:!0,capture:!0},Oe=new Date,De=function(e,t){ue||(ue=t,le=e,pe=new Date,Ue(removeEventListener),Re())},Re=function(){if(le>=0&&le<pe-Oe){var e={entryType:"first-input",name:ue.type,target:ue.target,cancelable:ue.cancelable,startTime:ue.timeStamp,processingStart:ue.timeStamp+le};me.forEach((function(t){t(e)})),me=[]}},Be=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){De(e,t),i()},o=function(){i()},i=function(){removeEventListener("pointerup",n,Pe),removeEventListener("pointercancel",o,Pe)};addEventListener("pointerup",n,Pe),addEventListener("pointercancel",o,Pe)}(t,e):De(t,e)}},Ue=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,Be,Pe)}))},He=[100,300],je=[2500,4e3],$e={},qe=[800,1800],Fe=function e(t){document.prerendering?Ae((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},ze=function(e,t){t=t||{};var n=ye("TTFB"),o=be(e,n,qe,t.reportAllChanges);Fe((function(){var i=ge();if(i){var r=i.responseStart;if(r<=0||r>performance.now())return;n.value=Math.max(r-we(),0),n.entries=[i],o(!0),he((function(){n=ye("TTFB",0),(o=be(e,n,qe,t.reportAllChanges))(!0)}))}}))};const We=(e,t)=>{const n=t.pageViewToken,o=[],i=e=>{o.push(e)};!function(e,t){t=t||{},Ne(Ce((function(){var n,o=ye("CLS",0),i=0,r=[],a=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=r[0],n=r[r.length-1];i&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,r.push(e)):(i=e.value,r=[e])}})),i>o.value&&(o.value=i,o.entries=r,n())},s=ve("layout-shift",a);s&&(n=be(e,o,Me,t.reportAllChanges),Te((function(){a(s.takeRecords()),n(!0)})),he((function(){i=0,o=ye("CLS",0),n=be(e,o,Me,t.reportAllChanges),ke((function(){return n()}))})),setTimeout(n,0))})))}(i),function(e,t){t=t||{},Ae((function(){var n,o=Le(),i=ye("FID"),r=function(e){e.startTime<o.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},a=function(e){e.forEach(r)},s=ve("first-input",a);n=be(e,i,He,t.reportAllChanges),s&&Te(Ce((function(){a(s.takeRecords()),s.disconnect()}))),s&&he((function(){var o;i=ye("FID"),n=be(e,i,He,t.reportAllChanges),me=[],le=-1,ue=null,Ue(addEventListener),o=r,me.push(o),Re()}))}))}(i),function(e,t){t=t||{},Ae((function(){var n,o=Le(),i=ye("LCP"),r=function(e){var t=e[e.length-1];t&&t.startTime<o.firstHiddenTime&&(i.value=Math.max(t.startTime-we(),0),i.entries=[t],n())},a=ve("largest-contentful-paint",r);if(a){n=be(e,i,je,t.reportAllChanges);var s=Ce((function(){$e[i.id]||(r(a.takeRecords()),a.disconnect(),$e[i.id]=!0,n(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return setTimeout(s,0)}),!0)})),Te(s),he((function(o){i=ye("LCP"),n=be(e,i,je,t.reportAllChanges),ke((function(){i.value=performance.now()-o.timeStamp,$e[i.id]=!0,n(!0)}))}))}}))}(i),ze(i),Ne(i);const r=()=>{const t={};if(o.length){o.forEach((({name:e,value:n,entries:o})=>{const i=e.toLocaleLowerCase();t[i]=Math.round(n),"CLS"===e&&(t[`${i}Entries`]=o.length)}));const i=Math.round(0),r={schemaId:L.WebVitals,payload:{pageViewToken:n,...i?{framesPerSecond:i}:{},...t.ttfb?{timeToFirstByte:t.ttfb}:{},...t.fcp?{firstContentfulPaint:t.fcp}:{},...t.fid?{firstInputDelay:t.fid}:{},...t.lcp?{largestContentfulPaint:t.lcp}:{},...t.cls?{cumulativeLayoutShift:t.cls}:{},...t.clsEntries?{cumulativeLayoutShiftEntries:t.clsEntries}:{}}};e.dux(r,{flush:!0})}};D([[j.BeforeUnload,r,document.body,!0],[j.VisibilityChange,r,document,!0],[j.PageHide,r,window,!0],[L.PageView,r,document,!0]])};class Ge{store;queue;debounceFlush;constructor(e,t=new Array){this.store=e,this.queue=t,this.track=this.track.bind(this),this.flush=this.flush.bind(this),this.debounceFlush=ae(this.flush.bind(this),250)}track(e,t){const{flush:n=!1,preserveCase:o=[],clientMessageId:i=f()}=t||{};if((e=>void 0!==e.schemaId)(e)){const t={...e,payload:R(e.payload,o),options:{convertEventCase:!1}};this.queue.push({metadata:{eventCreatedAtMs:Date.now(),clientMessageId:i},...t})}else this.queue.push(e);n||this.queue.length>=5?this.flush():this.debounceFlush()}flush(){const e=[...this.queue];this.queue.length=0,e.length&&this.send(e)}async send(e){const t={multiTrackToken:this.store.multiTrackToken||"",sessionToken:this.store.sessionToken||"",events:e},n=JSON.stringify(t),o=this.store.eventHandlerEndpoint||"/__dux";try{if(this.isSendBeaconAndBlobSupported()){const e=new window.Blob([n],{type:"application/json"});if(window.navigator.sendBeacon.bind(window.navigator)(o,e))return Promise.resolve({status:200})}}catch{}return fetch(o,{method:l.Post,headers:{"cache-control":"no-cache","Content-Type":"application/json"},credentials:"include",body:n}).then((e=>({response:e,message:t,status:e.status||0}))).catch((e=>({message:t,status:0,error:e})))}isSendBeaconAndBlobSupported(){return window&&window.navigator&&"function"==typeof window.navigator.sendBeacon&&"function"==typeof window.Blob}}class Xe{store;queue;queueInterval=null;constructor(e,t=new Array){this.store=e,this.queue=t,this.track=this.track.bind(this)}track(e,t={}){const n={project:"brochure",service:this.store.service,user_token:this.store.multiTrackToken||"",event:"event",event_non_interaction:"false",event_context:t,experiment_variation_id:this.store.experimentVariationId||"",...R(e)};window.dataLayer?window.dataLayer.push(n):(this.queue.push(n),this.queueInterval||(this.queueInterval=setInterval((()=>{if(window.dataLayer)for(this.queueInterval&&clearInterval(this.queueInterval);this.queue.length;){const e=this.queue.shift();window.dataLayer.push(e)}}),100)))}}const Ze=()=>new Promise((e=>{const t=()=>{const n=window.analytics?.trekkie;n?e(n):setTimeout(t,100)};t()})).then((e=>e.defaultAttributes?.microSessionId||"")),Ke=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IS","IE","IT","LV","LI","LT","LU","MT","NL","NO","PL","PT","RO","SI","SK","ES","SE","CH","GB"];var Je={excludedTlds:[".spin.dev",".workers.dev",".myshopify.io",".myshopify.dev"],includedTlds:[".com",".com.br",".co.uk",".dev",".engineering",".io",".ai",".app"]};const{includedTlds:Ye,excludedTlds:Qe}=Je,et={debug:!0,emitTrekkiePageViewEvent:!0,enableActiveConsent:!1,isReady:!1},tt=e=>{const t=e?{domain:e}:{},n=y(a.MultiTrackToken),o=n||f();o!==n&&v(a.MultiTrackToken,o,{...t,maxage:31536e6,path:"/",secure:!0,samesite:"lax"});const i=y(a.SessionToken),r=i||f();return r!==i&&v(a.SessionToken,r,{...t,maxage:18e5,path:"/",secure:!0,samesite:"lax"}),{multiTrackToken:o,sessionToken:r,isNewUser:o!==n}},nt=(e,t)=>{const n=e.pageViewToken||f(),{metadata:o,canonicalUrl:i}=e,r=new URL(t),s=(e=>{const{hostname:t}=e,n=Ye.find((e=>t.endsWith(e)));if(n&&!Qe.find((e=>t.endsWith(e))))return`.${t.split(n)[0].split(".").pop()}${n}`;if(t.startsWith("www."))return`.${t.split("www.").pop()}`})(r),c=o?.site?.pathPrefix||(e=>{const t=e.host,n=g[t]||g.default;if("string"==typeof n)return n;const[,o=""]=e.pathname.toLowerCase().split("/");return n[o]||n.default||"en"})(r)||"",d=o?.page?.experimentVariationId||"",u={...o?.page,affiliate:o?.page?.affiliate||r.searchParams.get("partner")||y(a.Affiliate)||"",experimentVariationId:d},l={...o?.site,pathPrefix:c};return{pageViewToken:n,url:t,domain:s,pageLanguageCode:c?.substring(0,c.indexOf("-"))||"en",lastShopDomain:y(a.LastShop),canonicalUrl:i||document.querySelector('link[rel="canonical"]')?.getAttribute("href")||t.split(/[?#]/)[0],experimentVariationId:d,metadata:{...o,title:o?.title||document.title,language:o?.page?.language||navigator.language||"",page:u,site:l,regions:[]}}},ot=async(e,t,n=et)=>{const{countryCode:o,regionCode:i,emitTrekkiePageViewEvent:r}=e,a=((e="",t="")=>e&&Ke.includes(e.toUpperCase())?s.Gdpr:"US"===e.toUpperCase()&&"CA"===t.toUpperCase()?s.Ccpa:s.None)(o,i),c=window.location.href,d=r?f():await Ze(),u=nt({pageViewToken:d,...e},c),{domain:l}=u,p=Object.assign(n,{...e,...tt(l),...u,complianceZone:a,isReady:!0});return t&&t(p),p};e.duxStore=et,e.emitPageView=(e={})=>{te!==location.href&&(oe&&oe(e),document.dispatchEvent(new CustomEvent(L.PageView,{detail:e})))},e.init=async(e,t,n,o,i)=>{if("undefined"==typeof window)return;if(document.body.hasAttribute(h))return void console.warn("[dux] warning: only initialize dux once. React <StrictMode> re-renders in dev; so you can ignore this if in development mode.",e);P(),document.body.setAttribute(h,"1");const r=await ot(e,t,o||et),s=i||{dux:new Ge(r).track,gtm:e?.enableGtm?new Xe(r).track:void 0};n&&s&&n(s);const c=(e={})=>{t?t(e,r):Object.assign(r,e)},{disableLogger:d}=e;d?.page||((e,t,n)=>{te="",n&&(oe=o=>{n(o),ne({track:e,store:t,softNavigation:!0})}),ne({track:e,store:t})})(s,r,((e={})=>{const t=window.location.href,n=nt(e,t),{domain:o}=n,i={...e,...tt(o),...n};c(i)})),d?.click||H(s,r,[document.body]),d?.componentViewability||((e,t)=>{(!window||"IntersectionObserver"in window)&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&(document.querySelectorAll("[data-viewable-component]").forEach((n=>G({track:e,store:t,dom:n}))),Object.values(z).forEach((({observer:e,dom:t})=>{e.observe(t)})))})(s,r),d?.error||J(s,r),d?.visibility||((e,t)=>{let n=(new Date).getTime();const o=o=>()=>{const r=(new Date).getTime(),a={schemaId:L.VisibilityChange,payload:{pageViewToken:t.pageViewToken||"",state:o,duration:Math.round(r-n)}};e.dux(a,{flush:!0}),n=r,i(o===re?ie:re)},i=e=>{D([[j.VisibilityChange,o(e),document],[e===re?j.PageShow:j.PageHide,o(e),window,!0]])};i(ie)})(s,r),d?.webVitals||We(s,r),d?.scroll||de(s,r),d?.form||Y(s,r),d?.trafficQuality||(async(e,t)=>{const n={schemaId:L.TrafficQuality,payload:{pageViewToken:t.pageViewToken||"",evalLength:eval.toString().length,hypotSolve:Math.hypot(-24.42,-50.519999999999925).toString(),screenWidth:screen.width,screenHeight:screen.height,navigatorWebdriver:navigator.webdriver,seleniumDocCheck:void 0!==document.$cdc_asdjflasutopfhvcZLmcfl_}};if(navigator.mediaDevices){const e=await navigator.mediaDevices.enumerateDevices();n.payload.mediaDevices=[...new Set(e)].map((e=>e.kind)).join(",")}e.dux(n)})(s,r);const{didomi:u}=e;if(u){const{isEnabled:e}=u;e&&(({track:e,store:t,accountId:n="8e59269b-18cb-4353-af05-7a9dd4ffe6c8",noticeId:o="tRNjMawc",didomiConfig:i={},onReady:r,updateStore:s})=>{const c=()=>{const e=y(a.DidomiToken)||y(a.DidomiTokenCpra),{didomiToken:n}=t;let o;if(e)try{o=JSON.parse(atob(e))}catch(e){console.error(e)}e!==n&&s({didomiToken:e,didomiStore:o})};window.didomiOnReady=window.didomiOnReady||[],window.didomiOnReady.push((function(e){c(),r&&r(e)})),window.didomiConfig={cookies:{storageSources:{cookies:!0,localStorage:!1}},...i,...b(window.location.href)},window.didomiEventListeners=window.didomiEventListeners||[],window.didomiEventListeners.push({event:"consent.changed",listener(){c()}}),function(e,t){var n=document.createElement("link");n.rel="preconnect",n.as="script";var o=document.createElement("link");o.rel="dns-prefetch",o.as="script";var i=document.createElement("link");i.rel="preload",i.as="script";var r=document.createElement("script");r.id="spcloader",r.type="text/javascript",r.async=!0,r.charset="utf-8";var a="https://sdk.privacy-center.org/"+e+"/loader.js?target_type=notice&target="+t;if(window.didomiConfig&&window.didomiConfig.user){var s=window.didomiConfig.user,c=s.country,d=s.region;c&&(a=a+"&country="+c,d&&(a=a+"&region="+d))}n.href="https://sdk.privacy-center.org/",o.href="https://sdk.privacy-center.org/",i.href=a,r.src=a;var u=document.getElementsByTagName("script")[0];u.parentNode.insertBefore(n,u),u.parentNode.insertBefore(o,u),u.parentNode.insertBefore(i,u),u.parentNode.insertBefore(r,u)}(n,o)})({track:s,store:r,...u,updateStore:c})}},e.observeComponentViewability=G,e.unload=()=>{document.body.hasAttribute(h)&&(document.body.removeAttribute(h),P(),oe=void 0),window.didomiOnReady&&(window.didomiOnReady=[],window.didomiEventListeners=[])},e.unobserveComponentViewability=W}));
//# sourceMappingURL=dux-3.4.1.min.js.map
